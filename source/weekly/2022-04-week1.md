# 2022年3月第五周简报

这周我也不知道是算是三月第五周还是四月第一周，不过先按照四月第一周来算！清明放假啦！

## 生活

1. 这周开的新的（复习）小说坑，大眼珠子的《异常生物见闻录》！
2. 这周一周没出门，不用通勤的感觉真好
3. 女朋友准备去给我买新的裤子（但是伦家更喜欢迷彩嘛）
4. 本周的伙食改善是巴奴毛肚火锅！啊，乌鱼片是我的爱！
5. 本周时间多了很多很多，开始看一些杂书，收获很多
6. 家里的植物开花的不错，真好
7. 周末的天气真好，和女朋友出门的时候，阳光暖洋洋的，很舒服
8. 本周开始健身环！被女朋友“嘲笑”了，我太菜了，呜呜呜
9. 看到了我捐助的女学生的近况，真好
10. 买了新的 iPad Pro ！

这周看了《病人家属，请来一下》，非常感动，突然想起孙思邈《大医精诚》中所言

> 凡大医治病，必当安神定志，无欲无求，先发大慈恻隐之心，誓愿普救含灵之苦。

在疾病面前，病人，家属，医生是天然的战友。我也更坚定了如果逝去，我一定要将我的遗体进行捐献。要是能培养出一个攻克某个疾病的医生，我也不枉来世上一回！

![资助的学生的近况](https://user-images.githubusercontent.com/7054676/161432868-867bf9d6-cfc7-4861-b86e-69ced00209ba.png)

安得广厦千万间 大庇天下寒士俱欢颜

## 技术

这周开始修养期，时间多了不少，但是有意识的控制了自己在技术上投入的精力，不过收获也还不少

1. [PR942](https://github.com/containerd/nerdctl/pull/942) 这个小的修复进入了主分支
2. 在使用 [bytebase](https://github.com/bytebase/bytebase) 这个新生的数据库管理工具的时候，发现了 [nerdctl](https://github.com/containerd/nerdctl) 的一个问题，不支持 `--init` 参数，参见 [Issue946](https://github.com/containerd/nerdctl/issues/946) ，写了一个 PR [PR948](https://github.com/containerd/nerdctl/pull/948) 去做这个事，在 Review 过程中，收获不少
    1. 之前我在 CI/CD 中依赖外部二进制的时候，并没有 checksum 的习惯，这其实不太妥当
    2. 这个 PR 实际上也是从20行代码发展到快两百行的。原因最开始是我认为这算是一个简单的功能迁移，所以只简单的加了一点 e2e 的测试确保能正常的run。但是后续经过作者的讨论后，我发现，实际上从我们自己的角度出发，添加了 `--init` 参数后，我们实际上是 hook 了 exec 初始进程。我们需要额外的一些 test case 来保证信号转发的功能是正常的 work 。所以我额外构造了一组算是巧妙的 case 完成了这一测试，详情参见 PR
3. 这周在关注容器热迁移的方面的工作，尝试给 nerdctl 添加 checkpoint 的支持，参见 [Issue956](https://github.com/containerd/nerdctl/issues/956) ，实际上 PR 已经写完了，但是吧，但是吧，CRIU 这个项目，一直处于不稳定的状态，比如 CRIU 在 Linux 5.13 下，对容器内的 mount 点的 checkpoint 会有问题。参见 [Issue860](https://github.com/checkpoint-restore/criu/issues/860)。 我没太大把握能让这个功能稳定的跑完 CI。跑不过 CI 的功能意义也不算大，所以先暂时放弃了
4. 与此对应，[Kubernetes](https://github.com/kubernetes/kubernetes) 社区的朋友也在做 checkpoint 的支持。参见 [PR104907](https://github.com/kubernetes/kubernetes/pull/104907) ，但是吧，外部依赖太不稳定了，我估计这个功能短时间内都无法被大规模的使用
5. 帮一个朋友给他的朋友做了一点渗透测试，提了一些安全加固建议。实际上对于一些在 PoC 期的产品来说，大概做好以下一些常见防护其实就能规避很多问题
    1. 对于用户的 API 的操作，需要有着限速，黑名单功能（比如验证码提交接口，如果不加防护，那么可以直接爆破）
    2. 对于所依赖的付费资源，需要在业务逻辑上做好限制使用的防护
    3. 对于图片，文字之类且带有社交分享功能的产品，需要做好内容安全防护（比如黄图 etc）
    4. 最好不要将自己服务器的裸 IP 地址暴露在公网，最好充分利用 CDN 所带来的能力
6. 这周吃 Prometheus 的坑，日经问题之 bucket 设置的不合理导致 histogram 不准，以及日经问题之 Prometheus 集群方案哪家强Hhhhh

这周因为对于 Web3 有点兴趣，现在也是合适的时候去了解一下，所以开了新坑《精通以太坊：开发智能合约和去中心化应用》这本书，写的很不错。非常推荐Hhhhh

这周另外还发生一些事，具体可以看我下面的吐槽

![吐槽1](https://user-images.githubusercontent.com/7054676/161434100-1980f52d-d319-44cb-b9d9-25462f3744af.png)

![吐槽2](https://user-images.githubusercontent.com/7054676/161434074-8d64b908-923d-4ce3-9f1b-ebfb4fc3f697.png)

感慨还是很多的。可能我们无法改变这个世界，但是我希望我们自己还是能不忘记 open-source 给我们带来的最纯粹的感动，不要让劣币驱逐良币的现象进一步恶化下去。。

## 简单总结

可能春天来了的关系，情绪始终在波动。不过该做的事好像也都在做了。反正不虚度下去，那就挺好。未来？等未来再说吧

